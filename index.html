<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Goap FSM - Example</title>
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.min.css' integrity='sha512-EZLkOqwILORob+p0BXZc+Vm3RgJBOe1Iq/0fiI7r/wJgzOFZMlsqTa29UEl6v6U6gsV4uIpsNZoV32YZqrCRCQ==' crossorigin='anonymous'/>
</head>

<body>
    <script type="module">
        import { woodcutter } from './woodcutter.js';
        import { Goap } from './goap.js';
        let goap = new Goap(woodcutter);

        var fps = 1;
        var now, delta;
        var then = Date.now();
        var interval = 1000/fps;
      
        function loop(){
            requestAnimationFrame(loop);
            now = Date.now();
            delta = now - then;
            
            if (delta > interval) {              
                then = now - (delta % interval);
                update();
                draw();
            }
        }
        loop();

        function update(){
            goap.tick();
            //goap.debug();
        }

        function draw(){
            document.body.innerHTML = "";
            let el = document.createElement('div');
            Object.assign( el.style, {
                outline:'1px solid #CCC',
                padding:'15px',
                display:'inline-block',
                float:'left',
                minWidth:'200px',
                minHeight:'200px',
            } )
            el.innerHTML = `<u><b>Current State</b></u><br/>${goap.state.name}<pre>${JSON.stringify(goap.parameters, null, 2)}</pre>`;
            document.body.appendChild(el);
        }

    </script>
</body>

</html>